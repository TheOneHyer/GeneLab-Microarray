<tool id="GeneLab-Visualize" name="Visualize comparisons from processed GeneLab data" version="0.1.0">
    <requirements>
        <requirement type="package">GeneLab-Microarray</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        GeneLab-Microarray --galaxy -gt $counts_table -gm $sample_metadata -gp $padj -gc1 $condition1 -gc2 $condition2 -gotxt $dge_file -gohtml1 $html_file -gohtml2 '$html_file.extra_files_path' -gopng $png_file
    ]]></command>
    <inputs>
      <param type="file" name="counts_table" format="txt" label="A txt file containing sample counts for each gene" />
      <param type="file" name="sample_metadata" format="txt" label="A txt file containing sample metadata formatted in ISA. (S file needed specifically)" />
      <param type="float" name="padj" label="P-adj cutoff value to determine significant gene list and for plotting" />
      <param type="text" name="condition1" label="First condition to be compared" />
      <param type="text" name="condition2" label="Second condition to be compared" />
    </inputs>
    <outputs>
      <data format="txt" name="dge_file" label="${tool_name}_${condition1.value}-${condition2.value}.txt">
      <data format="html" name="html_file" label="${tool_name}_${condition1.value}-${condition2.value}_${padj.value}.html">
      <data format="png" name="png_file" label="${tool_name}_${condition1.value}-${condition2.value}_${padj.value}.png">
    </outputs>
    <tests>
        <test>
            <param name="counts_table" value="2.fastq"/>
            <param name="sample_metadata" value="2.fastq"/>
            <param name="padj" value="0.0000001"/>
            <param name="condition1" value="spaceflight"/>
            <param name="condition2" value="notreatment"/>
            <output name="dge_file" file="${tool_name}_${condition1.value}-${condition2.value}.txt"/>
            <output name="html_file" file="${tool_name}_${condition1.value}-${condition2.value}_${padj.value}.html"/>
            <output name="png_file" file="${tool_name}_${condition1.value}-${condition2.value}_${padj.value}.png"/>
        </test>
    </tests>
    <help><![CDATA[
        usage: GeneLab-Microarray [options] Output

Standardized processing pipeline for microarray data on GeneLab.

positional arguments:
  Output                The full path to the desired output directory.

optional arguments:
  -h, --help            show this help message and exit
  -p , --process        Specify for process mode. If specified, give a
                        directory to a GLDS directory to be processed.
  -b, --batch           Specify for batch processing submode (must also
                        specify process). If specified, input the full
                        directory to a batch.txt file (see README for format
                        guidelines) to the process flag.
  -v , --visualize      Specify for visualization mode. If selected, must
                        input a comma-separated list of factor values and an
                        adjusted p-value cutoff (ex. --visualize
                        flight,ground,0.1) to compare.
  -g, --galaxy          For use with Galaxy only. Same outputs as
                        visualization mode simply formatted in a way thats
                        compatible with Galaxy tools.
  -gt , --galaxy_table 
                        For use with Galaxy input a counts table.
  -gm , --galaxy_meta   For use with Galaxy input the sample file from metadata
                        (starts with "s_").
  -gqc , --galaxy_qc    For use with Galaxy input the qc report.
  -gp , --galaxy_padj   For use with Galaxy input a p-adjusted cutoff value.
  -gc1 , --galaxy_condition1 
                        For use with Galaxy input condition1.
  -gc2 , --galaxy_condition2 
                        For use with Galaxy input condition2.

    ]]></help>
    <citations>
        <citation type="bibtex">
@misc{githubGeneLab-Microarray,
  author = {Rubin, Jonathan},
  year = {2018},
  title = {GeneLab-Microarray},
  publisher = {GitHub},
  journal = {GitHub repository},
  url = {https://github.com/jdrubin91/GeneLab-Microarray},
}</citation>
    </citations>
</tool>